<?xml version="1.0" encoding="UTF-8"?>

<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog/1.9"
                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog/1.9
                  http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-1.9.xsd">

    <changeSet id="ehrinventoryapp-202106101955" author="ningosi" dbms="mysql">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                SELECT COUNT(*) FROM scheduler_task_config
                WHERE schedulable_class ='org.openmrs.module.ehrinventoryapp.task.CopyDrugsFromOpenmrsDrugToInventoryDrug'
                And name = 'Copy drugs to inventory_drug table'
            </sqlCheck>
        </preConditions>
        <comment>Copy drugs to inventory_drug table</comment>
        <insert tableName="scheduler_task_config">
            <column name="name" value="Copy drugs to inventory_drug table" />
            <column name="description" value="Copy drugs to inventory_drug table" />
            <column name="schedulable_class" value="org.openmrs.module.ehrinventoryapp.task.CopyDrugsFromOpenmrsDrugToInventoryDrug" />
            <column name="start_time_pattern" value="MM/dd/yyyy HH:mm:ss" />
            <column name="start_time" valueDate="2021-01-20T23:59:59" />
            <column name="repeat_interval" value="60" />
            <column name="start_on_startup" value="1" />
            <column name="date_created" valueDate="CURRENT_TIMESTAMP" />
            <column name="created_by" value="1" />
            <column name="uuid" value="35b6c2be-ca0d-11eb-9449-47161d6bf8ef" />
        </insert>
    </changeSet>
    <changeSet id="ehrinventoryapp-202107011136" author="ningosi" dbms="mysql">

        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                SELECT COUNT(*) FROM inventory_drug_unit WHERE name='EACH';
            </sqlCheck>
        </preConditions>
        <comment>Creating the drug unit by default </comment>
        <sql>
            INSERT INTO inventory_drug_unit(id,name,description,created_on,created_by) Values(1,'EACH','Default drug unit',CURDATE(),'admin');
        </sql>
    </changeSet>

</databaseChangeLog>